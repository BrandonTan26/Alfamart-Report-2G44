<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Laporan Per Shift - KP Garung Tambak (Versi PRO + GAP)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
  :root {
    --bg-main: #050718;
    --bg-card: rgba(10, 12, 32, 0.98);
    --bg-card-soft: rgba(18, 22, 52, 0.98);
    --text-main: #f8f8ff;
    --text-muted: #a6add8;
    --neon-primary: #4f8cff;
    --neon-secondary: #a855ff;
    --border-soft: #262b4a;
    --font-main: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    --font-mono: "SF Mono", Menlo, Monaco, Consolas, "Courier New", monospace;
  }

  body.light {
    --bg-main: #eef1ff;
    --bg-card: #ffffff;
    --bg-card-soft: #ffffff;
    --text-main: #141621;
    --text-muted: #6a6f90;
    --border-soft: #d9ddf4;
  }

  * {
    box-sizing: border-box;
  }

  body {
    margin: 0;
    padding: 16px;
    background:
      radial-gradient(circle at top left, rgba(79, 140, 255, 0.35), transparent 55%),
      radial-gradient(circle at bottom right, rgba(168, 85, 255, 0.28), transparent 60%),
      radial-gradient(circle at center, #050718, #050210);
    font-family: var(--font-main);
    color: var(--text-main);
    transition: background 0.3s ease, color 0.3s ease;
  }

  body.light {
    background:
      radial-gradient(circle at top left, rgba(79, 140, 255, 0.14), transparent 55%),
      radial-gradient(circle at bottom right, rgba(168, 85, 255, 0.16), transparent 60%),
      linear-gradient(135deg, #eef1ff, #ffffff);
  }

  .wrap {
    max-width: 980px;
    margin: 0 auto 40px auto;
    position: relative;
  }

  .wrap::before {
    content: "";
    pointer-events: none;
    position: absolute;
    inset: 0;
    background-image: linear-gradient(
      to bottom,
      rgba(255, 255, 255, 0.03) 1px,
      transparent 1px
    );
    background-size: 100% 3px;
    opacity: 0.10;
    mix-blend-mode: soft-light;
  }

  .header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 16px;
    margin-bottom: 14px;
    position: relative;
    z-index: 1;
  }

  .brand-block {
    display: flex;
    gap: 14px;
    align-items: center;
  }

  .logo-alfamart {
    padding: 6px 14px;
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.12);
    background:
      radial-gradient(circle at 20% 0%, rgba(255, 255, 255, 0.16), transparent 55%),
      linear-gradient(135deg, #111632, #050718);
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .logo-alfamart img.logo-img {
    height: 30px;
    display: block;
  }

  .brand-text {
    display: flex;
    flex-direction: column;
    gap: 2px;
  }

  .brand-title {
    font-size: 20px;
    font-weight: 900;
    letter-spacing: 0.18em;
    text-transform: uppercase;
    color: var(--text-main);
    text-shadow:
      0 0 10px rgba(0, 0, 0, 0.6),
      0 0 16px rgba(79, 140, 255, 0.55);
  }

  .brand-sub {
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 0.18em;
    color: var(--text-muted);
  }

  .toggle-theme {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 7px 11px;
    border-radius: 999px;
    border: 1px solid rgba(255, 255, 255, 0.20);
    background: rgba(11, 14, 40, 0.95);
    cursor: pointer;
    font-size: 11px;
    color: var(--text-muted);
    position: relative;
    z-index: 1;
  }

  body.light .toggle-theme {
    background: rgba(255, 255, 255, 0.98);
    border-color: rgba(0, 0, 0, 0.06);
  }

  .toggle-pill {
    width: 42px;
    height: 18px;
    border-radius: 999px;
    background: linear-gradient(135deg, var(--neon-primary), var(--neon-secondary));
    position: relative;
    border: 1px solid rgba(255, 255, 255, 0.4);
  }

  .toggle-knob {
    width: 14px;
    height: 14px;
    border-radius: 999px;
    background: #050713;
    position: absolute;
    top: 1px;
    left: 2px;
    transition: transform 0.25s ease, background 0.25s ease;
  }

  body.light .toggle-knob {
    transform: translateX(20px);
    background: #fdfcff;
  }

  .mode-label {
    white-space: nowrap;
  }

  .divider-neon {
    height: 2px;
    border-radius: 999px;
    background: linear-gradient(90deg, transparent, var(--neon-primary), var(--neon-secondary), transparent);
    box-shadow:
      0 0 14px rgba(79, 140, 255, 0.55),
      0 0 14px rgba(168, 85, 255, 0.55);
    margin-bottom: 10px;
    opacity: 0.9;
    position: relative;
    z-index: 1;
  }

  .section-nav {
    display: inline-flex;
    flex-wrap: wrap;
    gap: 6px;
    margin-bottom: 12px;
    position: relative;
    z-index: 1;
  }

  .nav-chip {
    border: none;
    cursor: pointer;
    font-size: 11px;
    padding: 6px 10px;
    border-radius: 999px;
    letter-spacing: 0.14em;
    text-transform: uppercase;
    background: rgba(12, 15, 44, 0.96);
    color: var(--text-muted);
    border: 1px solid rgba(255, 255, 255, 0.12);
    display: inline-flex;
    align-items: center;
    gap: 4px;
    transition: background 0.2s ease, color 0.2s ease, box-shadow 0.2s ease, transform 0.1s ease;
  }

  .nav-chip span.icon {
    font-size: 12px;
  }

  .nav-chip:hover {
    color: #fefeff;
    box-shadow: 0 0 10px rgba(79, 140, 255, 0.6);
    transform: translateY(-1px);
  }

  body.light .nav-chip {
    background: rgba(255, 255, 255, 0.98);
    border-color: rgba(0, 0, 0, 0.06);
  }

  .nav-chip.active {
    background: linear-gradient(135deg, var(--neon-primary), var(--neon-secondary));
    color: #060717;
    box-shadow:
      0 0 12px rgba(79, 140, 255, 0.7),
      0 0 12px rgba(168, 85, 255, 0.7);
  }

  .card {
    position: relative;
    background:
      radial-gradient(circle at top left, rgba(255, 255, 255, 0.04), transparent 60%),
      radial-gradient(circle at bottom right, rgba(79, 140, 255, 0.16), transparent 70%),
      var(--bg-card);
    border-radius: 18px;
    padding: 14px 14px 12px 14px;
    border: 1px solid var(--border-soft);
    box-shadow: 0 10px 24px rgba(0, 0, 0, 0.35);
    margin-bottom: 12px;
    z-index: 1;
  }

  body.light .card {
    background:
      radial-gradient(circle at top left, rgba(79, 140, 255, 0.04), transparent 60%),
      radial-gradient(circle at bottom right, rgba(168, 85, 255, 0.05), transparent 70%),
      var(--bg-card-soft);
    box-shadow: 0 6px 18px rgba(15, 23, 42, 0.08);
  }

  .card-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 8px;
    margin-bottom: 8px;
  }

  .card-title {
    font-size: 12px;
    text-transform: uppercase;
    letter-spacing: 0.20em;
    color: var(--text-muted);
  }

  .card-title strong {
    color: var(--neon-primary);
  }

  .badge-kpi {
    font-size: 10px;
    padding: 2px 9px;
    border-radius: 999px;
    border: 1px solid rgba(255, 255, 255, 0.16);
    color: var(--text-muted);
    background: rgba(12, 15, 44, 0.9);
  }

  .grid-2 {
    display: grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap: 8px 12px;
  }

  @media (max-width: 720px) {
    .header {
      flex-direction: column;
      align-items: flex-start;
    }
    .grid-2 {
      grid-template-columns: 1fr;
    }
  }

  label {
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 0.12em;
    margin-bottom: 4px;
    display: block;
    color: var(--text-muted);
  }

  input[type="text"],
  input[type="number"],
  input[type="date"] {
    width: 100%;
    padding: 7px 9px;
    border-radius: 10px;
    border: 1px solid var(--border-soft);
    background: rgba(8, 10, 30, 0.96);
    color: var(--text-main);
    font-size: 12px;
    outline: none;
    transition: border 0.15s ease, box-shadow 0.15s ease, background 0.15s ease;
  }

  body.light input[type="text"],
  body.light input[type="number"],
  body.light input[type="date"] {
    background: #f8f8ff;
  }

  input[type="text"]:focus,
  input[type="number"]:focus,
  input[type="date"]:focus {
    border-color: var(--neon-primary);
    box-shadow: 0 0 10px rgba(79, 140, 255, 0.55);
  }

  input[readonly] {
    opacity: 0.7;
    cursor: default;
    background: rgba(18, 20, 42, 0.98);
  }

  body.light input[readonly] {
    background: #eef0ff;
  }

  .note {
    font-size: 11px;
    color: var(--text-muted);
    margin-top: 6px;
  }

  .kpi-row {
    border-left: 3px solid var(--neon-primary);
    padding-left: 10px;
  }

  .kpi-row.yellow {
    border-left-color: var(--neon-secondary);
  }

  .kpi-name {
    font-size: 13px;
    font-weight: 700;
    letter-spacing: 0.20em;
    text-transform: uppercase;
    margin-bottom: 6px;
    color: var(--neon-primary);
  }

  .btn-row {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin-bottom: 8px;
  }

  button {
    border: none;
    cursor: pointer;
    font-size: 12px;
    padding: 8px 14px;
    border-radius: 999px;
    font-weight: 600;
    letter-spacing: 0.10em;
    text-transform: uppercase;
    display: inline-flex;
    align-items: center;
    gap: 6px;
    position: relative;
    overflow: hidden;
    transition: transform 0.15s ease, opacity 0.15s ease;
  }

  button span.icon {
    font-size: 13px;
  }

  button.btn-red {
    background: linear-gradient(135deg, #4f8cff, #2b5fbf);
    color: #fdfdff;
  }

  button.btn-yellow {
    background: linear-gradient(135deg, #a855ff, #6d28d9);
    color: #fdfdff;
  }

  button.btn-wa {
    background: linear-gradient(135deg, #00c96f, #008c48);
    color: #f5fff9;
  }

  button:hover {
    transform: translateY(-1px);
    opacity: 0.96;
  }

  button:active {
    transform: translateY(1px);
    opacity: 0.9;
  }

  textarea {
    width: 100%;
    min-height: 260px;
    padding: 10px 10px;
    border-radius: 12px;
    border: 1px solid var(--border-soft);
    background:
      radial-gradient(circle at top left, rgba(79, 140, 255, 0.12), transparent 70%),
      radial-gradient(circle at bottom right, rgba(168, 85, 255, 0.10), transparent 70%),
      rgba(6, 8, 28, 0.98);
    color: var(--text-main);
    font-size: 12px;
    font-family: var(--font-mono);
    white-space: pre-wrap;
    resize: vertical;
    outline: none;
  }

  body.light textarea {
    background:
      radial-gradient(circle at top left, rgba(79, 140, 255, 0.06), transparent 70%),
      radial-gradient(circle at bottom right, rgba(168, 85, 255, 0.05), transparent 70%),
      #fdfdff;
  }

  .status-bar {
    font-size: 11px;
    color: var(--text-muted);
    margin-bottom: 6px;
  }

  .status-bar span.label {
    text-transform: uppercase;
    letter-spacing: 0.16em;
    font-size: 10px;
  }

  .pill-status {
    display: inline-flex;
    align-items: center;
    padding: 2px 10px;
    font-size: 10px;
    border-radius: 999px;
    border: 1px solid rgba(255, 255, 255, 0.16);
    margin-left: 4px;
  }

  .pill-status.ok {
    border-color: rgba(56, 189, 148, 0.7);
    color: #6ee7b7;
  }

  .pill-status.bad {
    border-color: rgba(239, 68, 68, 0.7);
    color: #fecaca;
  }

  .footer {
    margin-top: 22px;
    padding-top: 10px;
    border-top: 1px solid rgba(255, 255, 255, 0.14);
    text-align: center;
    font-size: 11px;
    color: var(--text-muted);
    position: relative;
    z-index: 1;
  }

  .footer-main {
    margin-bottom: 3px;
    letter-spacing: 0.16em;
    text-transform: uppercase;
    background: linear-gradient(90deg, var(--neon-primary), var(--neon-secondary));
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    text-shadow:
      0 0 10px rgba(79, 140, 255, 0.7),
      0 0 10px rgba(168, 85, 255, 0.7);
  }

  .footer-sub {
    letter-spacing: 0.08em;
    text-transform: uppercase;
  }

  .motivation-list {
    font-size: 11.5px;
    color: var(--text-muted);
    margin: 4px 0 2px 0;
    padding-left: 18px;
  }

  .motivation-list li {
    margin-bottom: 3px;
  }

  .motivation-title {
    font-size: 12px;
    text-transform: uppercase;
    letter-spacing: 0.16em;
    margin-bottom: 6px;
    color: var(--neon-primary);
  }
  </style>
</head>
<body class="dark">
  <div class="wrap">
    <!-- HEADER -->
    <div class="header">
      <div class="brand-block">
        <div class="logo-alfamart">
          <img src="alfamart-logo.png" alt="Alfamart" class="logo-img" />
        </div>
        <div class="brand-text">
          <div class="brand-title">KP GARUNG TAMBAK</div>
          <div class="brand-sub">Laporan Per Shift ¬∑ Space Blue Template</div>
        </div>
      </div>

      <button class="toggle-theme" id="themeToggle" type="button">
        <div class="toggle-pill">
          <div class="toggle-knob"></div>
        </div>
        <span class="mode-label">Dark Mode</span>
      </button>
    </div>

    <div class="divider-neon"></div>

    <!-- SECTION NAV -->
    <div class="section-nav">
      <button type="button" class="nav-chip active" onclick="scrollToSection('section-panduan')">
        <span class="icon">üìò</span>
        <span>Panduan</span>
      </button>
      <button type="button" class="nav-chip" onclick="scrollToSection('section-isi-laporan')">
        <span class="icon">üßæ</span>
        <span>Isi Laporan</span>
      </button>
      <button type="button" class="nav-chip" onclick="scrollToSection('section-motivasi')">
        <span class="icon">‚≠ê</span>
        <span>Motivasi</span>
      </button>
    </div>

    <!-- PANDUAN -->
    <div class="card" id="section-panduan">
      <div class="card-header">
        <div class="card-title"><strong>Panduan</strong> ¬∑ Cara Pakai Template Ini</div>
        <span class="badge-kpi">Guide</span>
      </div>
      <div>
        <p style="font-size:12px; margin:0 0 6px 0; font-weight:600;">Versi sopan & jelas untuk kasir</p>
        <ol style="margin:0 0 8px 16px; padding:0; font-size:12px; color:var(--text-main);">
          <li>Isi <strong>Tanggal, Nama Kasir, AC, dan Shift</strong>.</li>
          <li>Isi <strong>Hutang Kemarin</strong> dan <strong>ACTUAL</strong> pada setiap KPI sesuai pencapaian shift Anda.</li>
          <li>Klik <strong>Generate Laporan</strong>.</li>
          <li>Periksa hasil laporan di kotak bawah.</li>
          <li>Klik <strong>Copy Laporan</strong>.</li>
          <li>Klik <strong>Kirim ke Grup WA</strong>, lalu <strong>paste</strong> laporan di grup.</li>
          <li>Jika ada kesalahan angka, ubah input ‚Üí klik <strong>Generate</strong> kembali.</li>
        </ol>
        <p class="note">
          <strong>Total Target = Target Hari Ini + Hutang Kemarin</strong>.  
          GAP, status (Lebih/Kurang/Tercapai), dan ACV% dihitung otomatis.
        </p>
      </div>
    </div>

    <!-- DATA UMUM -->
    <div class="card" id="section-isi-laporan">
      <div class="card-header">
        <div class="card-title"><strong>Input Laporan</strong> ¬∑ Data Umum Shift</div>
        <span class="badge-kpi">KP GARUNG TAMBAK</span>
      </div>
      <div class="grid-2">
        <div>
          <label>Nama Toko</label>
          <input type="text" id="namaToko" value="KP GARUNG TAMBAK" />
        </div>
        <div>
          <label>Tanggal</label>
          <input type="date" id="tanggal" />
        </div>
        <div>
          <label>COS</label>
          <input type="text" id="cos" value="BRANDO" />
        </div>
        <div>
          <label>Nama Kasir</label>
          <input type="text" id="namaKasir" placeholder="Isi nama kasir" />
        </div>
        <div>
          <label>AC</label>
          <input type="text" id="ac" placeholder="Isi nama AC" />
        </div>
        <div>
          <label>Shift</label>
          <input type="number" id="shift" min="1" max="3" placeholder="1 / 2" />
        </div>
      </div>
      <p class="note">
        Target KPI di bawah <strong>fix</strong>. Kasir cukup isi <strong>Hutang Kemarin</strong> dan <strong>ACTUAL</strong> untuk shift yang sedang dijalankan.
      </p>
    </div>

    <!-- PSM -->
    <div class="card">
      <div class="card-header">
        <div class="card-title">KPI ¬∑ <strong>PSM</strong></div>
        <span class="badge-kpi">Up-Selling</span>
      </div>
      <div class="kpi-row">
        <div class="kpi-name">PSM</div>
        <div class="grid-2">
          <div>
            <label>Target Shift 1</label>
            <input type="number" id="psmTarget1" value="15" readonly />
          </div>
          <div>
            <label>Target Shift 2</label>
            <input type="number" id="psmTarget2" value="25" readonly />
          </div>
          <div>
            <label>Hutang Kemarin</label>
            <input type="number" id="psmHutangPrev" value="0" />
          </div>
          <div>
            <label>ACTUAL (shift yang jaga)</label>
            <input type="number" id="psmActual" placeholder="Isi PSM shift ini" />
          </div>
        </div>
      </div>
    </div>

    <!-- PWP -->
    <div class="card">
      <div class="card-header">
        <div class="card-title">KPI ¬∑ <strong>PWP</strong></div>
        <span class="badge-kpi">Bundling</span>
      </div>
      <div class="kpi-row yellow">
        <div class="kpi-name">PWP</div>
        <div class="grid-2">
          <div>
            <label>Target Shift 1</label>
            <input type="number" id="pwpTarget1" value="7" readonly />
          </div>
          <div>
            <label>Target Shift 2</label>
            <input type="number" id="pwpTarget2" value="15" readonly />
          </div>
          <div>
            <label>Hutang Kemarin</label>
            <input type="number" id="pwpHutangPrev" value="0" />
          </div>
          <div>
            <label>ACTUAL (shift yang jaga)</label>
            <input type="number" id="pwpActual" placeholder="Isi PWP shift ini" />
          </div>
        </div>
      </div>
    </div>

    <!-- SERTIS -->
    <div class="card">
      <div class="card-header">
        <div class="card-title">KPI ¬∑ <strong>SERTIS</strong></div>
        <span class="badge-kpi">Sertifikasi Struk</span>
      </div>
      <div class="kpi-row">
        <div class="kpi-name">SERTIS</div>
        <div class="grid-2">
          <div>
            <label>Target Shift 1</label>
            <input type="number" id="sertisTarget1" value="9" readonly />
          </div>
          <div>
            <label>Target Shift 2</label>
            <input type="number" id="sertisTarget2" value="12" readonly />
          </div>
          <div>
            <label>Hutang Kemarin</label>
            <input type="number" id="sertisHutangPrev" value="0" />
          </div>
          <div>
            <label>ACTUAL (shift yang jaga)</label>
            <input type="number" id="sertisActual" placeholder="Isi Sertis shift ini" />
          </div>
        </div>
      </div>
    </div>

    <!-- PROMO SUEGER (tanpa hutang, tetap ACV struk) -->
    <div class="card">
      <div class="card-header">
        <div class="card-title">KPI ¬∑ <strong>Promo Sueger</strong></div>
        <span class="badge-kpi">Redeem</span>
      </div>
      <div class="kpi-row yellow">
        <div class="kpi-name">PROMO SUEGER</div>
        <div class="grid-2">
          <div>
            <label>Target % ke syarat</label>
            <input type="number" id="suegerTargetPct" value="20" readonly />
          </div>
          <div>
            <label>Struk Bersyarat</label>
            <input type="number" id="suegerBersyarat" placeholder="Struk memenuhi syarat" />
          </div>
          <div>
            <label>Struk Redeem</label>
            <input type="number" id="suegerRedeem" placeholder="Struk redeem" />
          </div>
        </div>
        <p class="note">
          ACV Sueger = (Struk Redeem / Struk Bersyarat) √ó 100%. Tidak pakai hutang.
        </p>
      </div>
    </div>

    <!-- NEW MEMBER -->
    <div class="card">
      <div class="card-header">
        <div class="card-title">KPI ¬∑ <strong>New Member</strong></div>
        <span class="badge-kpi">Akuisisi</span>
      </div>
      <div class="kpi-row yellow">
        <div class="kpi-name">NEW MEMBER</div>
        <div class="grid-2">
          <div>
            <label>Target Shift 1</label>
            <input type="number" id="nmTarget1" value="1" readonly />
          </div>
          <div>
            <label>Target Shift 2</label>
            <input type="number" id="nmTarget2" value="1" readonly />
          </div>
          <div>
            <label>Hutang Kemarin</label>
            <input type="number" id="nmHutangPrev" value="0" />
          </div>
          <div>
            <label>ACTUAL (shift yang jaga)</label>
            <input type="number" id="nmActual" placeholder="Isi NM shift ini" />
          </div>
        </div>
      </div>
    </div>

    <!-- TELUR -->
    <div class="card">
      <div class="card-header">
        <div class="card-title">KPI ¬∑ <strong>Telur Ayam Negeri</strong></div>
        <span class="badge-kpi">SKU Fokus</span>
      </div>
      <div class="kpi-row">
        <div class="kpi-name">TELUR AYAM NEGERI</div>
        <div class="grid-2">
          <div>
            <label>Target pack / shift</label>
            <input type="number" id="telurTargetShift" value="1" readonly />
          </div>
          <div>
            <label>Hutang Kemarin</label>
            <input type="number" id="telurHutangPrev" value="0" />
          </div>
          <div>
            <label>ACTUAL (shift yang jaga, pack)</label>
            <input type="number" id="telurActual" placeholder="Total pack telur shift ini" />
          </div>
        </div>
      </div>
    </div>

    <!-- OUTPUT -->
    <div class="card">
      <div class="card-header">
        <div class="card-title"><strong>Output</strong> ¬∑ Laporan Siap Kirim WA</div>
        <span class="badge-kpi">Shift Report</span>
      </div>

      <div class="status-bar" id="statusSummary">
        <span class="label">Status KPI</span> ¬∑ Belum digenerate
      </div>

      <div class="btn-row">
        <button type="button" class="btn-red" onclick="generateLaporan()">
          <span class="icon">‚ö°</span>
          <span>Generate Laporan</span>
        </button>
        <button type="button" class="btn-yellow" onclick="copyLaporan()">
          <span class="icon">üìã</span>
          <span>Copy Laporan</span>
        </button>
        <button type="button" class="btn-wa" onclick="openWhatsAppGroup()">
          <span class="icon">üü¢</span>
          <span>Kirim ke Grup WA</span>
        </button>
      </div>

      <textarea id="output" placeholder="Klik 'Generate Laporan' dulu, lalu copy dan paste di grup WA..."></textarea>
      <p class="note">
        Flow: isi data ‚Üí klik <strong>Generate</strong> ‚Üí <strong>Copy</strong> ‚Üí <strong>Kirim ke Grup WA</strong> ‚Üí paste di chat.
      </p>
    </div>

    <!-- MOTIVASI -->
    <div class="card" id="section-motivasi">
      <div class="card-header">
        <div class="card-title"><strong>Motivasi</strong> ¬∑ Versi Pendek & Ngena</div>
        <span class="badge-kpi">Untuk Kasir</span>
      </div>
      <div>
        <p class="motivation-title">Motivasi Shift</p>
        <ul class="motivation-list">
          <li>‚ÄúKerja Anda hari ini menentukan hasil toko besok.‚Äù</li>
          <li>‚ÄúTarget bukan tekanan, tapi arah.‚Äù</li>
          <li>‚ÄúPelayanan kecil Anda punya dampak besar.‚Äù</li>
          <li>‚ÄúSetiap shift adalah kesempatan memperbaiki.‚Äù</li>
          <li>‚ÄúKerja hebat lahir dari konsistensi sederhana.‚Äù</li>
          <li>‚ÄúSenyum Anda adalah branding toko.‚Äù</li>
          <li>‚ÄúYang penting bukan cepat, tapi tepat.‚Äù</li>
          <li>‚ÄúCapek itu wajar, menyerah itu tidak.‚Äù</li>
        </ul>
      </div>
    </div>

    <!-- FOOTER -->
    <div class="footer">
      <div class="footer-main">¬© 2025 D&D A DIGITAL CREATIVE STUDIO ‚Äî Retail Tools & Templates</div>
      <div class="footer-sub">Crafted by Brandon Tan</div>
    </div>
  </div>

  <script>
  // THEME TOGGLE
  (function initTheme() {
    const body = document.body;
    const toggle = document.getElementById("themeToggle");
    const label = toggle.querySelector(".mode-label");

    function applyTheme(mode) {
      if (mode === "light") {
        body.classList.remove("dark");
        body.classList.add("light");
        label.textContent = "Light Mode";
      } else {
        body.classList.remove("light");
        body.classList.add("dark");
        label.textContent = "Dark Mode";
      }
    }

    const saved = localStorage.getItem("reportTheme");
    if (saved === "light" || saved === "dark") {
      applyTheme(saved);
    } else {
      applyTheme("dark");
    }

    toggle.addEventListener("click", () => {
      const cur = body.classList.contains("light") ? "light" : "dark";
      const next = cur === "light" ? "dark" : "light";
      applyTheme(next);
      localStorage.setItem("reportTheme", next);
    });
  })();

  // SECTION NAV SCROLL
  function scrollToSection(id) {
    const el = document.getElementById(id);
    if (!el) return;
    el.scrollIntoView({ behavior: "smooth", block: "start" });

    const chips = document.querySelectorAll(".nav-chip");
    chips.forEach(ch => ch.classList.remove("active"));

    if (id === "section-panduan") {
      chips[0]?.classList.add("active");
    } else if (id === "section-isi-laporan") {
      chips[1]?.classList.add("active");
    } else if (id === "section-motivasi") {
      chips[2]?.classList.add("active");
    }
  }

  function formatTanggalId(value) {
    if (!value) return "";
    const parts = value.split("-");
    if (parts.length !== 3) return value;
    return parts[2] + "-" + parts[1] + "-" + parts[0]; // dd-mm-yyyy
  }

  // KPI dengan hutang: PSM, PWP, SERTIS, NM
  function hitungKpiWithDebt(target1, target2, hutangPrev, actual, shift) {
    const t1 = Number(target1) || 0;
    const t2 = Number(target2) || 0;
    const hut = Number(hutangPrev) || 0;
    const act = Number(actual) || 0;
    const sh = Number(shift) || 0;

    let baseTarget = 0;
    if (sh === 1) baseTarget = t1;
    else if (sh === 2) baseTarget = t2;
    else baseTarget = t1 + t2;

    const totalTarget = baseTarget + hut;
    let acv = 0;
    if (totalTarget > 0) acv = (act / totalTarget) * 100;
    const acvRounded = Math.round(acv);

    const gap = act - totalTarget;
    let statusGap = "Tercapai";
    if (gap > 0) statusGap = "Lebih";
    else if (gap < 0) statusGap = "Kurang";

    return {
      t1,
      t2,
      baseTarget,
      hutangPrev: hut,
      totalTarget,
      act,
      acvRounded,
      gap,
      statusGap
    };
  }

  // KPI single target per shift: TELUR
  function hitungSingleKpiWithDebt(targetPerShift, hutangPrev, actual) {
    const baseTarget = Number(targetPerShift) || 0;
    const hut = Number(hutangPrev) || 0;
    const act = Number(actual) || 0;

    const totalTarget = baseTarget + hut;
    let acv = 0;
    if (totalTarget > 0) acv = (act / totalTarget) * 100;
    const acvRounded = Math.round(acv);

    const gap = act - totalTarget;
    let statusGap = "Tercapai";
    if (gap > 0) statusGap = "Lebih";
    else if (gap < 0) statusGap = "Kurang";

    return {
      baseTarget,
      hutangPrev: hut,
      totalTarget,
      act,
      acvRounded,
      gap,
      statusGap
    };
  }

  function formatGapLine(k) {
    const num = k.gap > 0 ? "+" + k.gap : String(k.gap);
    return `GAP : ${num} (${k.statusGap})`;
  }

  function formatGapShort(k) {
    const num = k.gap > 0 ? "+" + k.gap : String(k.gap);
    return `${num} ${k.statusGap}`;
  }

  function generateLaporan() {
    const namaToko = document.getElementById("namaToko").value || "";
    const tanggalRaw = document.getElementById("tanggal").value || "";
    const tanggal = formatTanggalId(tanggalRaw);
    const cos = document.getElementById("cos").value || "";
    const namaKasir = document.getElementById("namaKasir").value || "";
    const ac = document.getElementById("ac").value || "";
    const shift = document.getElementById("shift").value || "";
    const shNum = Number(shift) || 0;

    // PSM
    const psm = hitungKpiWithDebt(
      document.getElementById("psmTarget1").value,
      document.getElementById("psmTarget2").value,
      document.getElementById("psmHutangPrev").value,
      document.getElementById("psmActual").value,
      shNum
    );

    // PWP
    const pwp = hitungKpiWithDebt(
      document.getElementById("pwpTarget1").value,
      document.getElementById("pwpTarget2").value,
      document.getElementById("pwpHutangPrev").value,
      document.getElementById("pwpActual").value,
      shNum
    );

    // SERTIS
    const sertis = hitungKpiWithDebt(
      document.getElementById("sertisTarget1").value,
      document.getElementById("sertisTarget2").value,
      document.getElementById("sertisHutangPrev").value,
      document.getElementById("sertisActual").value,
      shNum
    );

    // NEW MEMBER
    const nm = hitungKpiWithDebt(
      document.getElementById("nmTarget1").value,
      document.getElementById("nmTarget2").value,
      document.getElementById("nmHutangPrev").value,
      document.getElementById("nmActual").value,
      shNum
    );

    // TELUR
    const telur = hitungSingleKpiWithDebt(
      document.getElementById("telurTargetShift").value,
      document.getElementById("telurHutangPrev").value,
      document.getElementById("telurActual").value
    );

    // PROMO SUEGER
    const suegerTargetPct = Number(document.getElementById("suegerTargetPct").value) || 0;
    const suegerBersyarat = Number(document.getElementById("suegerBersyarat").value) || 0;
    const suegerRedeem = Number(document.getElementById("suegerRedeem").value) || 0;
    let suegerAcv = 0;
    if (suegerBersyarat > 0) {
      suegerAcv = (suegerRedeem / suegerBersyarat) * 100;
    }
    const suegerAcvRounded = Math.round(suegerAcv);

    const laporan =
`LAPORAN PERSHIFT
NAMA TOKO  : ${namaToko}
TANGGAL    : ${tanggal}
COS        : ${cos}
NAMA KASIR : ${namaKasir}
AC         : ${ac}
SHIFT      : ${shift}

*PSM*
TARGET SHIFT : ${psm.baseTarget}
HUTANG KEMARIN : ${psm.hutangPrev}
TOTAL TARGET   : ${psm.totalTarget}
ACTUAL         : ${psm.act}
${formatGapLine(psm)}
ACV            : ${psm.acvRounded}%

*PWP*
TARGET SHIFT : ${pwp.baseTarget}
HUTANG KEMARIN : ${pwp.hutangPrev}
TOTAL TARGET   : ${pwp.totalTarget}
ACTUAL         : ${pwp.act}
${formatGapLine(pwp)}
ACV            : ${pwp.acvRounded}%

*SERTIS*
TARGET SHIFT : ${sertis.baseTarget}
HUTANG KEMARIN : ${sertis.hutangPrev}
TOTAL TARGET   : ${sertis.totalTarget}
ACTUAL         : ${sertis.act}
${formatGapLine(sertis)}
ACV            : ${sertis.acvRounded}%

*PROMO SUEGER*
TARGET ${suegerTargetPct}% TO SYARAT
STRUK BERSYARAT : ${suegerBersyarat}
STRUK REDEEM    : ${suegerRedeem}
ACV%            : ${suegerAcvRounded}%

*NEW MEMBER*
TARGET SHIFT : ${nm.baseTarget}
HUTANG KEMARIN : ${nm.hutangPrev}
TOTAL TARGET   : ${nm.totalTarget}
ACTUAL         : ${nm.act}
${formatGapLine(nm)}
ACV%           : ${nm.acvRounded}%

*TELUR AYAM NEGERI*
TARGET SHIFT : ${telur.baseTarget} PACK
HUTANG KEMARIN : ${telur.hutangPrev}
TOTAL TARGET   : ${telur.totalTarget}
ACTUAL         : ${telur.act}
${formatGapLine(telur)}
ACV%           : ${telur.acvRounded}%`;

    document.getElementById("output").value = laporan;

    // STATUS BAR
    const statusSummary = document.getElementById("statusSummary");
    function pill(text, ok) {
      const cls = ok ? "pill-status ok" : "pill-status bad";
      return `<span class="${cls}">${text}</span>`;
    }

    const parts = [];
    parts.push('<span class="label">Status KPI</span> ¬∑ ');
    parts.push('PSM ');
    parts.push(pill(formatGapShort(psm), psm.gap >= 0));
    parts.push(' ¬∑ PWP ');
    parts.push(pill(formatGapShort(pwp), pwp.gap >= 0));
    parts.push(' ¬∑ SERTIS ');
    parts.push(pill(formatGapShort(sertis), sertis.gap >= 0));
    parts.push(' ¬∑ NM ');
    parts.push(pill(formatGapShort(nm), nm.gap >= 0));
    parts.push(' ¬∑ TELUR ');
    parts.push(pill(formatGapShort(telur), telur.gap >= 0));

    statusSummary.innerHTML = parts.join("");
  }

  async function copyLaporan() {
    const textarea = document.getElementById("output");
    const text = textarea.value || "";
    if (!text.trim()) {
      alert("Belum ada laporan. Klik GENERATE dulu.");
      return;
    }

    try {
      if (navigator.clipboard && navigator.clipboard.writeText) {
        await navigator.clipboard.writeText(text);
      } else {
        textarea.select();
        textarea.setSelectionRange(0, 99999);
        document.execCommand("copy");
      }
      alert("Laporan sudah di-copy. Tinggal paste di WA.");
    } catch (e) {
      console.error(e);
      textarea.select();
      textarea.setSelectionRange(0, 99999);
      document.execCommand("copy");
      alert("Clipboard tidak mendukung penuh. Laporan sudah diseleksi, silakan copy manual.");
    }
  }

  function openWhatsAppGroup() {
    const url = "https://chat.whatsapp.com/IQcVASSrOnwLsqWKSP4agt?mode=hqrc";
    window.open(url, "_blank");
  }
  </script>
</body>
</html>
